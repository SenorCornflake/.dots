#!/usr/bin/env bash

hc() {
    herbstclient "$@"
}

#hc emit_hook reload

# AUTOSTART
# Notification daemon
pidof dunst || dunst &

# Update interval
# pgrep updates.sh || sh $DOTFILES_BRAIN_ROOT/scripts/updates.sh &

# Compositor
pidof picom || picom --experimental-backends --shadow-ignore-shaped &

# Thingy
pidof xsettingsd || xsettingsd &

# Polkit
pidof /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 || /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &

# X settings
xset r rate 250 30 
xsetroot -cursor_name left_ptr

# Enable nightmode if it was enabled prior to restarting
python $DOTFILES_BRAIN_ROOT/scripts/night_mode.py

# WALLPAPERS #
sh $DOTFILES_BRAIN_ROOT/scripts/generate_wallapers.sh
sh $DOTFILES_BRAIN_ROOT/scripts/set_wallpaper.sh

# MONITORS #
hc detect_monitors

sh ~/.config/herbstluftwm/keybindings
sh ~/.config/herbstluftwm/settings
sh ~/.config/herbstluftwm/rules

# unlock, just to be sure
hc unlock

killall polybar
exconman set polybar.pin_workspaces "false"
python $DOTFILES_BRAIN_ROOT/scripts/launch_polybars.py &
